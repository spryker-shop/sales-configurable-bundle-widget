{% extends template('widget') %}

{% define data = {
    items: _widget.items,
    salesOrderConfiguredBundles: _widget.salesOrderConfiguredBundles,
} %}

{% block body %}
    {% for bundle in data.salesOrderConfiguredBundles %}
        {% block bundleItem %}
            {% embed molecule('ordered-configured-bundle', 'SalesConfigurableBundleWidget') ignore missing with {
                data: {
                    bundle: bundle,
                    items: data.items,
                },
            } only %}
                {% block bundleProductItem %}
                    {% include molecule('ordered-configured-bundle-product-secondary', 'SalesConfigurableBundleWidget') with {
                        data: {
                            product: data.items[item.IdSalesOrderItem],
                            currencyIsoCode: item.currencyIsoCode ?? data.currencyIsoCode,
                            image: data.items[item.IdSalesOrderItem].metadata.image,
                        },
                    } only %}
                {% endblock %}
            {% endembed %}
        {% endblock %}
    {% endfor %}
{% endblock %}
